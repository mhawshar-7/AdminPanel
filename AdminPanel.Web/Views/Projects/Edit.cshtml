@model AdminPanel.Web.Models.ProjectViewModel
@using Microsoft.AspNetCore.Mvc.Rendering
@{
    ViewData["Title"] = Model?.Id > 0 ? "Edit Project" : "Create Project";
}

<!--begin::Form wrapper-->
<form id="project_form" asp-action="Edit" method="post" class="form d-flex flex-column flex-lg-row gap-7 gap-lg-10" novalidate>
    @Html.AntiForgeryToken()
    <input type="hidden" asp-for="Id" />

    <!--begin::Aside column-->
    <div class="d-flex flex-column gap-7 w-100 w-lg-300px mb-7 mb-lg-0">
        <!--begin::Status card-->
        <div class="card card-flush py-4">
            <div class="card-header">
                <div class="card-title"><h2>Status</h2></div>
                @* <div class="card-toolbar">
                    <div class="rounded-circle w-15px h-15px bg-success" id="project_status_indicator"></div>
                </div> *@
            </div>
            <div class="card-body pt-0">
                <select asp-for="Status" class="form-select mb-2" data-control="select2" data-hide-search="true" data-placeholder="Select status" id="project_status_select" asp-items="Html.GetEnumSelectList<ProjectStatus>()"></select>
                <span asp-validation-for="Status" class="text-danger"></span>
                <div class="text-muted fs-7">Set the project status.</div>
            </div>
        </div>
        <!--end::Status card-->
        <!--begin::Dates card-->
        <div class="card card-flush py-4">
            <div class="card-header">
                <div class="card-title"><h2>Schedule</h2></div>
            </div>
            <div class="card-body pt-0">
                <div class="mb-10 fv-row">
                    <label asp-for="StartDate" class="form-label">Start Date</label>
                    <input asp-for="StartDate" type="date" class="form-control mb-2" />
                    <span asp-validation-for="StartDate" class="text-danger"></span>
                </div>
                <div class="mb-0 fv-row">
                    <label asp-for="EndDate" class="form-label">End Date</label>
                    <input asp-for="EndDate" type="date" class="form-control mb-2" />
                    <span asp-validation-for="EndDate" class="text-danger"></span>
                </div>
            </div>
        </div>
        <!--end::Dates card-->
        <!--begin::Finance card-->
        <div class="card card-flush py-4">
            <div class="card-header">
                <div class="card-title"><h2>Financial</h2></div>
            </div>
            <div class="card-body pt-0">
                <div class="mb-10 fv-row">
                    <label asp-for="Budget" class="form-label">Budget</label>
                    <input asp-for="Budget" class="form-control mb-2" type="number" />
                    <span asp-validation-for="Budget" class="text-danger"></span>
                </div>
                <div class="mb-0 fv-row">
                    <label asp-for="ClientId" class="form-label">Client</label>
                    <select asp-for="ClientId"
                            class="form-select mb-2"
                            data-control="select2"
                            data-placeholder="Select client"
                            asp-items="Model?.Clients">
                        <option value="">Select client</option>
                    </select>
                    <span asp-validation-for="ClientId" class="text-danger"></span>
                </div>
            </div>
        </div>
    </div>
    <!--end::Aside column-->
    <!--begin::Main column-->
    <div class="d-flex flex-column flex-row-fluid gap-7 gap-lg-10">
        <!--begin::General card-->
        <div class="card card-flush py-4">
            <div class="card-header">
                <div class="card-title"><h2>General</h2></div>
            </div>
            <div class="card-body pt-0">
                <div asp-validation-summary="ModelOnly" class="text-danger mb-5"></div>
                <div class="mb-10 fv-row">
                    <label asp-for="Name" class="required form-label">Project Name</label>
                    <input asp-for="Name" class="form-control mb-2" placeholder="Project name" />
                    <span asp-validation-for="Name" class="text-danger"></span>
                    <div class="text-muted fs-7">A project name is required and should be unique.</div>
                </div>
                <div class="mb-10 fv-row">
                    <label asp-for="Description" class="form-label">Description</label>
                    <textarea asp-for="Description" class="form-control mb-2" rows="4" placeholder="Describe the project"></textarea>
                    <span asp-validation-for="Description" class="text-danger"></span>
                    <div class="text-muted fs-7">Add a descriptive summary for better visibility.</div>
                </div>
            </div>
        </div>
        <!--end::General card-->
        <!--begin::Actions-->
        <div class="d-flex justify-content-end">
            <a asp-action="Index" class="btn btn-light me-5">Cancel</a>
            <button type="submit" class="btn btn-primary" id="project_submit_btn">
                <span class="indicator-label">Save Changes</span>
                <span class="indicator-progress">Please wait... <span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>
            </button>
        </div>
        <!--end::Actions-->
    </div>
    <!--end::Main column-->
</form>
<!--end::Form wrapper-->
@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    @* <script>
        (function(){
            const indicator = document.getElementById('project_status_indicator');
            const select = document.getElementById('Status');
            const colorMap = {
                '0': 'bg-secondary', // example mapping; adjust based on enum underlying values
                '1': 'bg-success',
                '2': 'bg-warning',
                '3': 'bg-danger'
            };
            function updateIndicator(){
                if(!indicator || !select) return;
                indicator.className = 'rounded-circle w-15px h-15px ' + (colorMap[select.value] || 'bg-success');
            }
            select && select.addEventListener('change', updateIndicator);
            updateIndicator();
        })();
    </script> *@
}